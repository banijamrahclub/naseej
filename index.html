<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>حجز ملعب - نسيج</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg1: #0f2027;
      --bg2: #203a43;
      --accent: #ffb703;
      --card: rgba(255,255,255,0.06);
      --glass: rgba(255,255,255,0.04);
      --text: #f8f9fa;
      --muted: #cfd8dc;
      --success: #38a169;
      --booked: #b22a3b;
    }

    * { box-sizing: border-box; }
    
    body {
      margin: 0;
      min-height: 100vh;
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 100%);
      color: var(--text);
      display: flex;
      justify-content: center;
      padding: 20px;
      overflow-x: hidden;
    }

    .container {
      width: 100%;
      max-width: 900px; /* تقليل العرض الأقصى ليكون التصميم ملموماً أكثر */
    }

    .hero {
      background: rgba(255,255,255,0.03);
      padding: 1.5rem;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      border: 1px solid rgba(255,255,255,0.05);
    }

    .hero h1 { margin: 0 0 0.5rem 0; font-size: 1.5rem; text-align: center; }
    .hero p { margin: 0 0 1.5rem 0; color: var(--muted); text-align: center; font-size: 0.9rem; }

    .booking-form {
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
    }

    /* تقسيم الحقول */
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }

    .field-group { display: flex; flex-direction: column; gap: 0.5rem; }
    label { font-weight: 600; font-size: 0.9rem; color: var(--accent); }

    input[type="text"], input[type="tel"] {
      width: 100%;
      padding: 0.8rem;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.1);
      background: var(--glass);
      color: var(--text);
      outline: none;
    }

    /* منطقة التقويم والأوقات */
    .calendar-section {
      background: var(--card);
      padding: 1rem;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.05);
    }

    .month-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .month-nav button {
      background: var(--glass);
      border: none;
      color: white;
      padding: 5px 15px;
      border-radius: 5px;
      cursor: pointer;
    }

    .days-row {
      display: flex;
      gap: 10px;
      overflow-x: auto;
      padding-bottom: 10px;
      margin-bottom: 1rem;
      scrollbar-width: thin;
    }

    .day-card {
      min-width: 60px;
      padding: 10px;
      background: var(--glass);
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      transition: 0.3s;
    }

    .day-card.selected {
      background: var(--success);
      box-shadow: 0 0 15px rgba(56, 161, 105, 0.4);
    }
    .day-card.disabled { opacity: 0.45; cursor: not-allowed; }

    .day-card .num { font-weight: bold; font-size: 1.1rem; }
    .day-card .name { font-size: 0.75rem; opacity: 0.8; }

    /* شبكة الأوقات - 3 صفوف */
    .slots-grid {
      display: grid;
      grid-template-rows: repeat(3, 1fr);
      grid-auto-flow: column;
      gap: 8px;
      overflow-x: auto;
      padding: 5px 0;
    }

    .slot-btn {
      background: rgba(46, 161, 132, 0.15);
      border: 1px solid rgba(46, 161, 132, 0.3);
      color: #9ae6b4;
      padding: 8px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      white-space: nowrap;
      text-align: center;
      min-width: 90px;
    }

    .slot-btn.selected { background: var(--success); color: white; }
    .slot-btn.booked { background: rgba(255, 90, 102, 0.1); border-color: var(--booked); color: var(--booked); cursor: not-allowed; }

    /* المدة */
    .durations-row { display: flex; gap: 10px; flex-wrap: wrap; }
    .duration-btn {
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:6px;
      flex: 1;
      padding: 10px;
      background: var(--glass);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      font-size: 0.85rem;
      min-width:110px;
      box-sizing:border-box;
    }
    .duration-btn .label{font-weight:700}
    .duration-btn .price-block{display:flex;gap:8px;align-items:center}
    .duration-btn .orig-price{position:relative;color:#e6e6e6;padding:0 6px}
    .duration-btn .orig-price::after{content:'';position:absolute;left:-6px;right:-6px;top:50%;height:2px;background:linear-gradient(90deg,transparent,#e63946,transparent);transform:rotate(-15deg)}
    .duration-btn .discounted-price{color:#fff;font-weight:800}
    .duration-btn .badge{background:#e63946;color:#fff;padding:3px 6px;border-radius:6px;font-size:0.75rem;margin-right:6px}
    .duration-btn.active { border-color: var(--accent); color: var(--accent); background: rgba(255, 183, 3, 0.06); box-shadow: 0 6px 20px rgba(255,183,3,0.03)}

    /* الملخص */
    .summary-box {
      background: rgba(0,0,0,0.2);
      padding: 1rem;
      border-radius: 10px;
      font-size: 0.9rem;
      border-right: 4px solid var(--accent);
    }

    .summary-item { margin-bottom: 5px; display: flex; justify-content: space-between; }
    .price-tag { color: var(--accent); font-weight: bold; font-size: 1.2rem; }

    .submit-btn {
      background: var(--accent);
      color: #000;
      border: none;
      padding: 1rem;
      border-radius: 10px;
      font-weight: 700;
      font-size: 1.1rem;
      cursor: pointer;
      transition: 0.3s;
    }

    .submit-btn:disabled { opacity: 0.4; cursor: not-allowed; }

    /* Small device tweaks (keep your desktop sizes intact) */
    @media (max-width: 900px) {
      .container { max-width: 100%; padding: 12px; }
      .hero { padding: 1.2rem; }
    }

    @media (max-width: 700px) {
      .form-row { grid-template-columns: 1fr; }
      .hero { padding: 1rem; }

      /* make slots flow vertically in a compact grid on small screens */
      .slots-grid { grid-auto-flow: row; grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 6px; overflow-x: visible; }
      .slot-btn { min-width: unset; width: 100%; }

      /* days and durations adjustments for narrow screens */
      .days-row { gap: 8px; }
      .duration-btn { flex: unset; width: 48%; }
      .submit-btn { width: 100%; }
    }

    @media (max-width: 420px) {
      .slots-grid { grid-template-columns: repeat(2, 1fr); }
      .duration-btn { width: 100%; }
    }
    
    /* Modal for payment image (animated & smaller) */
    .modal-overlay {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      background: rgba(0,0,0,0);
      opacity: 0;
      pointer-events: none;
      transition: background 200ms ease, opacity 200ms ease;
    }
    .modal-overlay.show {
      background: rgba(0,0,0,0.6);
      opacity: 1;
      pointer-events: auto;
    }
    .modal-card {
      max-width: 640px;
      width: min(86%, 640px);
      background: #0f1720;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.6);
      border: 1px solid rgba(255,255,255,0.06);
      text-align: center;
      transform: translateY(10px) scale(0.98);
      opacity: 0;
      transition: transform 220ms cubic-bezier(.2,.9,.3,1), opacity 220ms ease;
    }
    .modal-overlay.show .modal-card {
      transform: translateY(0) scale(1);
      opacity: 1;
    }
    .modal-card img { max-width: 100%; height: auto; border-radius: 6px; display:block; margin: 0 auto; transform-origin:center center; }
    .modal-close {
      margin-top:8px;
      background:#fff;color:#000;padding:8px 12px;border-radius:8px;border:none;cursor:pointer;
    }
  </style>
</head>
<body>

<div class="container">
  <div class="hero">
    <h1>حجز ملعب - نِسيج ⚽</h1>
    <p>نظام حجز الملاعب الذكي - اختر موعدك المفضل</p>
    <div id="promoBanner" style="display:block;margin-top:8px;padding:8px;border-radius:8px;background:linear-gradient(90deg,#e63946,#ffbaba);color:#fff;font-weight:700;text-align:center">عرض خاص: ساعة ونصف بسعر 10 د، ساعتان بسعر 15 د</div>

    <form class="booking-form" id="bookingForm">
      <div class="form-row">
        <div class="field-group">
          <label>الاسم</label>
          <input type="text" id="userName" placeholder="محمد علي" required>
        </div>
        <div class="field-group">
          <label>رقم الهاتف</label>
          <div style="display:flex;gap:8px">
            <select id="countryCode" style="min-width:110px;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:var(--glass);color:var(--text)">
              <option value="+973" selected>+973 البحرين</option>
              <option value="+964">+964 العراق</option>
              <option value="+966">+966 السعودية</option>
              <option value="+971">+971 الإمارات</option>
              <option value="+962">+962 الأردن</option>
              <option value="+965">+965 الكويت</option>
              <option value="+963">+963 سوريا</option>
            </select>
            <input type="tel" id="userPhone" placeholder="770XXXXXXX" required>
          </div>
        </div>
      </div>

      <div class="field-group">
        <label>المدة</label>
        <div class="durations-row" id="durationOptions">
          <div class="duration-btn" data-mins="60" data-price="10">ساعة واحدة</div>
          <div class="duration-btn" data-mins="90" data-price="15">ساعة ونصف</div>
          <div class="duration-btn" data-mins="120" data-price="20">ساعتان</div>
        </div>
      </div>

      <div class="calendar-section">
        <div class="month-nav">
          <button type="button" id="prevW">السابق</button>
          <span id="monthName">يناير 2026</span>
          <button type="button" id="nextW">التالي</button>
        </div>
        
        <div class="days-row" id="daysRow"></div>
        
        <label style="display:block; margin-bottom:10px;">الأوقات المتاحة:</label>
        <div class="slots-grid" id="slotsGrid"></div>
      </div>

      <div class="summary-box">
        <div class="summary-item"><span>التكلفة:</span> <span class="price-tag" id="resPrice">--</span></div>
        <div class="summary-item"><span>الموعد:</span> <span id="resDate">--</span></div>
        <div class="summary-item"><span>نهاية الحجز:</span> <span id="resEnd">--</span></div>
      </div>

      <div style="display:flex;gap:8px;align-items:center;">
        <button type="submit" class="submit-btn" id="subBtn" disabled>احجز الآن</button>
        <button type="button" id="payNowBtn" class="submit-btn" style="background:#1a73e8;color:#fff">الدفع الآن</button>
      </div>
    </form>

    <div class="calendar-section" style="margin-top:1rem">
      <h3 style="margin:0 0 8px 0">حجوزاتي</h3>
      <div style="display:flex;gap:8px;align-items:center;margin-bottom:8px;">
        <select id="myCountryCode" style="min-width:110px;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:var(--glass);color:var(--text)">
          <option value="+973" selected>+973 البحرين</option>
          <option value="+964">+964 العراق</option>
          <option value="+966">+966 السعودية</option>
          <option value="+971">+971 الإمارات</option>
          <option value="+962">+962 الأردن</option>
          <option value="+965">+965 الكويت</option>
          <option value="+963">+963 سوريا</option>
        </select>
        <input type="tel" id="myPhone" placeholder="770XXXXXXX" style="flex:1;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:var(--glass);color:var(--text)">
        <button type="button" id="loadMy" class="submit-btn" style="padding:8px 12px;margin-left:8px">عرض حجوزاتي</button>
      </div>
      <div id="myList" style="background:var(--card);padding:8px;border-radius:8px">لا توجد حجوزات</div>
    </div>

  </div>
</div>

<script>
  let selectedDate = "";
  let selectedTime = "";
  let selectedPrice = 0;
  let selectedMins = 0;
  let currentDate = new Date();

  // العروض الثابتة: طبق العرض المحدد (ساعة ونصف = 10 د، ساعتان = 15 د)
  const promotions = { '90': 10, '120': 15 };

  function decorateDurations(){
    document.querySelectorAll('.duration-btn').forEach(btn=>{
      const mins = Number(btn.dataset.mins);
      const base = Number(btn.dataset.price);
      const label = btn.textContent.trim();
      if(promotions[mins]){
        btn.innerHTML = `<div class="label">${label}</div><div class="price-block"><span class="orig-price">${base} د</span><span class="discounted-price">${promotions[mins]} د <span class="badge">عرض خاص</span></span></div>`;
      } else {
        btn.innerHTML = `<div class="label">${label}</div><div class="price-block"><span class="discounted-price">${base} د</span></div>`;
      }
    });
  }
  // decorate once with the fixed promotions
  decorateDurations();

  const monthNames = ['يناير','فبراير','مارس','أبريل','مايو','يونيو','يوليو','أغسطس','سبتمبر','أكتوبر','نوفمبر','ديسمبر'];

  const daysRow = document.getElementById('daysRow');
  const slotsGrid = document.getElementById('slotsGrid');
  const resPrice = document.getElementById('resPrice');
  const resDate = document.getElementById('resDate');
  const resEnd = document.getElementById('resEnd');
  const subBtn = document.getElementById('subBtn');

  // إنشاء الأيام
  function todayString(){ const t = new Date(); return t.toISOString().split('T')[0]; }
  function renderDays(date) {
    daysRow.innerHTML = '';
    const today = todayString();
    for (let i = -2; i < 8; i++) {
      let d = new Date(date);
      d.setDate(d.getDate() + i);
      let dayCard = document.createElement('div');
      dayCard.className = 'day-card';
      let dStr = d.toISOString().split('T')[0];
      if(dStr === selectedDate) dayCard.classList.add('selected');
      if(dStr < today){ dayCard.classList.add('disabled'); }

      dayCard.innerHTML = `
        <div class="name">${d.toLocaleDateString('ar-EG', {weekday:'short'})}</div>
        <div class="num">${d.getDate()}</div>
      `;
      dayCard.onclick = () => {
        if(dStr < today){ alert('لا يمكنك الحجز في تواريخ سابقة'); return; }
        selectedDate = dStr;
        renderDays(date);
        renderSlots();
        updateSummary();
      };
      daysRow.appendChild(dayCard);
    }
    // عرض اسم الشهر للسنة بناءً على التاريخ الممرر (مركز الأسبوع)
    document.getElementById('monthName').textContent = monthNames[date.getMonth()] + ' ' + date.getFullYear();
  }

  // إنشاء الأوقات (3 صفوف)
  function renderSlots() {
    slotsGrid.innerHTML = '';
    if(!selectedDate){
      slotsGrid.innerHTML = '<div style="opacity:0.7">اختر يومًا لعرض الأوقات المتاحة</div>';
      return;
    }
    // block past dates
    if(selectedDate < todayString()){ slotsGrid.innerHTML = '<div style="opacity:0.8">لا يمكنك الحجز في هذا التاريخ</div>'; return; }
    // جلب الأوقات المتاحة من السيرفر
    fetch('/api/slots?date=' + selectedDate).then(r=>r.json()).then(list=>{
      list.forEach(s => {
        const btn = document.createElement('div');
        btn.className = 'slot-btn';
        btn.textContent = formatAMPM(Number(s.time.split(':')[0]), Number(s.time.split(':')[1]));
        if(!s.available){ btn.classList.add('booked'); }
        if(s.time === selectedTime) btn.classList.add('selected');
        if(s.available){ btn.onclick = () => { selectedTime = s.time; renderSlots(); updateSummary(); }; }
        slotsGrid.appendChild(btn);
      });
    }).catch(err=>{
      // في حال فشل السيرفر، اعرض الأوقات محلياً
      for (let h = 8; h <= 23; h++) {
        [0, 30].forEach(m => {
          let time = `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}`;
          let btn = document.createElement('div');
          btn.className = 'slot-btn';
          btn.textContent = formatAMPM(h, m);
          if(time === selectedTime) btn.classList.add('selected');
          btn.onclick = () => { selectedTime = time; renderSlots(); updateSummary(); };
          slotsGrid.appendChild(btn);
        });
      }
      // add midnight slot
      const midnightBtn = document.createElement('div'); midnightBtn.className='slot-btn'; midnightBtn.textContent = formatAMPM(0,0); midnightBtn.onclick = ()=>{ selectedTime='00:00'; renderSlots(); updateSummary(); }; slotsGrid.appendChild(midnightBtn);
    });
  }

  function formatAMPM(h, m) {
    let ampm = h >= 12 ? 'م' : 'ص';
    let hour = h % 12 || 12;
    return `${hour}:${m.toString().padStart(2, '0')} ${ampm}`;
  }

  // المدة
  document.querySelectorAll('.duration-btn').forEach(btn => {
    btn.onclick = () => {
      document.querySelectorAll('.duration-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      selectedMins = parseInt(btn.dataset.mins);
      const base = Number(btn.dataset.price);
      selectedPrice = promotions[selectedMins] ? promotions[selectedMins] : base;
      updateSummary();
    };
  });

  function updateSummary() {
    if(!selectedPrice) resPrice.textContent = '--';
    else {
      const base = selectedMins ? Number(document.querySelector(`.duration-btn[data-mins="${selectedMins}"]`).dataset.price) : null;
      if(base && promotions[selectedMins]){
        resPrice.innerHTML = `<span style="font-weight:800;color:#ffd700">${selectedPrice} دينار</span> <span style="margin-right:10px;color:#e63946;text-decoration:line-through;opacity:0.9">${base} د</span> <span style="background:#e63946;color:#fff;padding:2px 6px;border-radius:6px;font-size:0.8rem">عرض خاص</span>`;
      } else {
        resPrice.textContent = selectedPrice + ' دينار';
      }
    }

    resDate.textContent = (selectedDate && selectedTime) ? `${selectedDate} في ${selectedTime}` : "--";
    
    if(selectedTime && selectedMins) {
      let [h, m] = selectedTime.split(':').map(Number);
      let date = new Date();
      date.setHours(h, m + selectedMins);
      resEnd.textContent = formatAMPM(date.getHours(), date.getMinutes());
    }

    subBtn.disabled = !(selectedDate && selectedTime && selectedMins && document.getElementById('userName').value);
  }

  document.getElementById('prevW').onclick = () => { currentDate.setDate(currentDate.getDate() - 7); renderDays(currentDate); };
  document.getElementById('nextW').onclick = () => { currentDate.setDate(currentDate.getDate() + 7); renderDays(currentDate); };

  // User bookings
  function renderMyBookings(rows){
    const container = document.getElementById('myList'); container.innerHTML = '';
    if(!rows || rows.length===0){ container.textContent = 'لا توجد حجوزات'; return; }
    rows.forEach(r=>{
      const div = document.createElement('div'); div.style.padding='8px'; div.style.borderBottom='1px solid rgba(255,255,255,0.03)';
      const canCancel = (function(){ const dt = new Date(`${r.date}T${r.time}:00`); return dt.getTime() > Date.now(); })();
      div.innerHTML = `<div style="font-weight:700">${r.date} ${r.time} · ${r.duration} د</div><div style="opacity:0.9">${r.name} — ${r.phone}</div>`;
      // زر الإلغاء إذا كان مسموحًا
      if(canCancel){ const b = document.createElement('button'); b.textContent='إلغاء'; b.style.marginTop='6px'; b.onclick = async ()=>{ if(!confirm('هل تريد إلغاء هذا الحجز؟'))return; const res = await fetch('/api/bookings/'+r.id+'/cancel',{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify({phone:document.getElementById('myCountryCode').value + document.getElementById('myPhone').value.replace(/\D/g,'')})}); const data = await res.json(); if(res.ok){ alert('تم الإلغاء'); loadMyBookings(); renderDays(currentDate); renderSlots(); } else alert('فشل: '+(data.error||'غير متوقع')); }; div.appendChild(b); }
      // زر الدفع — يظهر لكل حجز لفتح نافذة الدفع
      const payBtn = document.createElement('button'); payBtn.textContent='دفع'; payBtn.style.marginTop='6px'; payBtn.style.marginLeft='8px'; payBtn.style.background='#1a73e8'; payBtn.style.color='#fff'; payBtn.onclick = ()=>{ showPaymentModal(); };
      div.appendChild(payBtn);
      container.appendChild(div);
    });
  }

  async function loadMyBookings(){
    const cc = document.getElementById('myCountryCode').value || '+973';
    const phoneRaw = document.getElementById('myPhone').value.trim();
    const digits = phoneRaw.replace(/\D/g,'');
    if(!digits){ alert('ادخل رقم هاتف لعرض حجوزاتك'); return; }
    const phone = digits.startsWith('+') ? digits : (digits.startsWith('0') ? cc + digits.replace(/^0+/, '') : cc + digits);
    localStorage.setItem('lastPhone', phone);
    const res = await fetch('/api/bookings/user?phone='+encodeURIComponent(phone));
    if(!res.ok){ alert('فشل جلب الحجوزات'); return; }
    const rows = await res.json(); renderMyBookings(rows);
  }

  document.getElementById('loadMy').onclick = loadMyBookings;
  // prefill last phone
  window.addEventListener('load', ()=>{ const lp = localStorage.getItem('lastPhone'); if(lp){ document.getElementById('myPhone').value = lp.replace(/^\+\d{1,3}/,''); const cc = '+'+lp.replace(/^\+/, '').slice(0,3); document.getElementById('myCountryCode').value = lp.slice(0,4) || '+973'; } });

  // إرسال الحجز إلى السيرفر
  document.getElementById('bookingForm').addEventListener('submit', async (e)=>{
    e.preventDefault();
    const name = document.getElementById('userName').value.trim();
    const cc = document.getElementById('countryCode').value || '+973';
    let phoneRaw = document.getElementById('userPhone').value.trim();
    let phoneDigits = phoneRaw.replace(/\D/g,'');
    if(!phoneDigits) return alert('ادخل رقم هاتف صحيح');
    let phone = phoneDigits.startsWith('0') ? cc + phoneDigits.replace(/^0+/, '') : (phoneDigits.startsWith('+') ? phoneDigits : cc + phoneDigits);
    if(!name || !phone || !selectedDate || !selectedTime || !selectedMins) return alert('اكمل الحقول المطلوبة');
    const payload = { name, phone, date: selectedDate, time: selectedTime, duration: selectedMins };
    try{
      const r = await fetch('/api/bookings', { method:'POST', headers:{'content-type':'application/json'}, body: JSON.stringify(payload) });
      const data = await r.json();
      if(r.status === 409){ alert('هذا الوقت محجوز، اختر وقتًا آخر'); renderSlots(); return; }
      if(!r.ok){ alert('خطأ: ' + (data.error || 'فشل الاتصال')); return; }
      // عرض تأكيد وحفظ الهاتف لعرض الحجوزات
      alert('تم الحجز بنجاح');
      localStorage.setItem('lastPhone', phone);
      // إذا واجهة "حجوزاتي" موجودة، قم بتعبئتها وعرض الحجوزات فورًا
      const myPhoneEl = document.getElementById('myPhone');
      const myCCEl = document.getElementById('myCountryCode');
      if(myPhoneEl) myPhoneEl.value = phone.replace(/^\+\d{1,3}/,'');
      if(myCCEl) myCCEl.value = phone.slice(0,4) || cc;
      // مسح الاختيارات
      selectedTime = ''; selectedDate = ''; selectedPrice = 0; selectedMins = 0;
      document.getElementById('userName').value=''; document.getElementById('userPhone').value='';
      renderDays(currentDate); renderSlots(); updateSummary();
      if(typeof loadMyBookings === 'function') loadMyBookings();
    }catch(err){ alert('فشل الاتصال بالسيرفر'); }
  });

  renderDays(currentDate);
  renderSlots();

  // Payment modal logic
  const payNowBtn = document.getElementById('payNowBtn');
  function showPaymentModal() {
    const overlay = document.getElementById('paymentModal');
    overlay.classList.add('show');
  }
  function hidePaymentModal() {
    const overlay = document.getElementById('paymentModal');
    overlay.classList.remove('show');
  }
  if(payNowBtn){
    payNowBtn.onclick = showPaymentModal;
  }
  // close when clicking overlay or close button
  document.addEventListener('click', (e)=>{
    const overlay = document.getElementById('paymentModal');
    if(!overlay) return;
    if(e.target === overlay || e.target.classList.contains('modal-close')) hidePaymentModal();
  });

</script>

<!-- Payment Modal -->
<div id="paymentModal" class="modal-overlay" role="dialog" aria-modal="true" aria-label="نافذة الدفع">
  <div class="modal-card">
    <img src="https://raw.githubusercontent.com/banijamrahclub/menbaralba/d07dc8f9872d6254f5238d5c84f2c72868cac8ad/WhatsApp%20Image%202026-01-30%20at%2011.08.09%20PM.jpeg" alt="تفاصيل الدفع">
    <div style="margin-top:8px">
      <button class="modal-close">إغلاق</button>
    </div>
  </div>
</div>

</body>
</html>